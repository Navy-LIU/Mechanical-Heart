# èŠå¤©å®¤ç³»ç»ŸåŠŸèƒ½æ”¹è¿›æ€»ç»“

## æ”¹è¿›æ¦‚è¿°

æœ¬æ¬¡æ”¹è¿›æ ¹æ®ç”¨æˆ·éœ€æ±‚ï¼Œå¯¹èŠå¤©å®¤ç³»ç»Ÿè¿›è¡Œäº†å…¨é¢çš„åŠŸèƒ½å‡çº§ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

## ğŸ†” 1. ç”¨æˆ·IDè‡ªåŠ¨åˆ†é…ç³»ç»Ÿ

### åŠŸèƒ½ç‰¹ç‚¹
- **è‡ªåŠ¨åˆ†é…**ï¼šç”¨æˆ·è¿æ¥æ—¶ç³»ç»Ÿè‡ªåŠ¨åˆ†é…å”¯ä¸€ç”¨æˆ·ID
- **åŸºäºIPç”Ÿæˆ**ï¼šä½¿ç”¨IPåœ°å€åä¸¤æ®µç”Ÿæˆæ›´å‹å¥½çš„IDæ ¼å¼
- **å”¯ä¸€æ€§ä¿è¯**ï¼šé€šè¿‡æ—¶é—´æˆ³å’Œè®¡æ•°å™¨ç¡®ä¿IDçš„å”¯ä¸€æ€§
- **æ ¼å¼ç¤ºä¾‹**ï¼š`u110073072800`ï¼ˆu + IPåç¼€ + æ—¶é—´æˆ³ + åºå·ï¼‰

### æŠ€æœ¯å®ç°
```python
def generate_user_id(self, ip_address: str = None) -> str:
    # åŸºäºIPåœ°å€å’Œæ—¶é—´æˆ³ç”Ÿæˆå”¯ä¸€ID
    # æ ¼å¼ï¼šu + IPåç¼€ + 6ä½æ—¶é—´æˆ³ + 2ä½åºå·
```

## ğŸ‘¤ 2. ç”¨æˆ·åè®¾ç½®åŠŸèƒ½

### åŠŸèƒ½ç‰¹ç‚¹
- **æ˜¾ç¤ºåç§°**ï¼šç”¨æˆ·å¯ä»¥è®¾ç½®ç‹¬ç«‹äºç”¨æˆ·åçš„æ˜¾ç¤ºåç§°
- **å®æ—¶æ›´æ–°**ï¼šæ”¯æŒåœ¨èŠå¤©è¿‡ç¨‹ä¸­åŠ¨æ€ä¿®æ”¹æ˜¾ç¤ºåç§°
- **å”¯ä¸€æ€§æ£€æŸ¥**ï¼šé˜²æ­¢æ˜¾ç¤ºåç§°å†²çª
- **é•¿åº¦é™åˆ¶**ï¼šæœ€å¤š20ä¸ªå­—ç¬¦

### ä½¿ç”¨æ–¹æ³•
- å‰ç«¯æä¾›"æ”¹å"æŒ‰é’®
- å¿«æ·é”®ï¼šCtrl+R
- WebSocketäº‹ä»¶ï¼š`update_display_name`

## ğŸŒ 3. åŸºäºIPåœ°å€çš„ç”¨æˆ·è¯†åˆ«

### åŠŸèƒ½ç‰¹ç‚¹
- **IPè®°å½•**ï¼šè®°å½•æ¯ä¸ªç”¨æˆ·çš„IPåœ°å€
- **IPç»Ÿè®¡**ï¼šæä¾›è¯¦ç»†çš„IPåœ°å€ç»Ÿè®¡ä¿¡æ¯
- **ç”¨æˆ·åˆ†ç»„**ï¼šæŒ‰IPåœ°å€å¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç»„ç®¡ç†
- **éšç§ä¿æŠ¤**ï¼šIPä¿¡æ¯ä»…ç”¨äºç³»ç»Ÿç®¡ç†ï¼Œä¸å¯¹å¤–æš´éœ²

### ç»Ÿè®¡ä¿¡æ¯
```python
{
    'total_ips': 5,  # æ€»IPæ•°é‡
    'ip_details': {
        '192.168.1.100': {
            'user_count': 2,
            'usernames': ['user1', 'user2'],
            'user_ids': ['u110073072800', 'u110173072801']
        }
    },
    'max_users_per_ip': 2  # å•ä¸ªIPæœ€å¤šç”¨æˆ·æ•°
}
```

## ğŸ”’ 4. 30ç”¨æˆ·é™åˆ¶ç³»ç»Ÿ

### åŠŸèƒ½ç‰¹ç‚¹
- **ç¡¬é™åˆ¶**ï¼šç³»ç»Ÿæœ€å¤šåŒæ—¶æ”¯æŒ30ä¸ªç”¨æˆ·
- **ä¼˜é›…æ‹’ç»**ï¼šè¶…å‡ºé™åˆ¶æ—¶å‹å¥½æç¤º"èŠå¤©å®¤å·²æ»¡"
- **å®æ—¶ç»Ÿè®¡**ï¼šæä¾›ç”¨æˆ·æ•°é‡å®æ—¶ç»Ÿè®¡
- **åŒ…å«AIç”¨æˆ·**ï¼š30ä¸ªç”¨æˆ·åŒ…æ‹¬1ä¸ªAIåŠ©æ‰‹

### å®ç°é€»è¾‘
```python
def _can_add_more_users(self) -> bool:
    current_user_count = self.get_online_user_count()
    return current_user_count < self.MAX_USERS
```

## ğŸ’¬ 5. æ¶ˆæ¯æ˜¾ç¤ºä¿®å¤

### é—®é¢˜è§£å†³
- **åŸé—®é¢˜**ï¼šç”¨æˆ·å‘é€æ¶ˆæ¯åçœ‹ä¸åˆ°è‡ªå·±çš„æ¶ˆæ¯
- **æ ¹æœ¬åŸå› **ï¼šå‰ç«¯æ²¡æœ‰ç›‘å¬æ­£ç¡®çš„å¹¿æ’­äº‹ä»¶
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ·»åŠ `broadcast_message`äº‹ä»¶ç›‘å¬

### æŠ€æœ¯æ”¹è¿›
- æ·»åŠ æ¶ˆæ¯å¹¿æ’­äº‹ä»¶å¤„ç†
- æ”¯æŒä¸åŒç±»å‹çš„æ¶ˆæ¯ï¼ˆç”¨æˆ·æ¶ˆæ¯ã€AIå›å¤ã€ç³»ç»Ÿæ¶ˆæ¯ï¼‰
- ç¡®ä¿å‘é€è€…ä¹Ÿèƒ½æ”¶åˆ°è‡ªå·±çš„æ¶ˆæ¯

## ğŸ› ï¸ 6. ç”¨æˆ·ç•Œé¢æ”¹è¿›

### æ–°å¢åŠŸèƒ½æŒ‰é’®
- **ä¿¡æ¯æŒ‰é’®**ï¼šæŸ¥çœ‹å½“å‰ç”¨æˆ·è¯¦ç»†ä¿¡æ¯
- **æ”¹åæŒ‰é’®**ï¼šå¿«é€Ÿä¿®æ”¹æ˜¾ç¤ºåç§°

### å¿«æ·é”®æ”¯æŒ
- `Ctrl+I`ï¼šæŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯
- `Ctrl+R`ï¼šä¿®æ”¹æ˜¾ç¤ºåç§°
- `Alt+A`ï¼šå¿«é€Ÿè¾“å…¥@AIï¼ˆåŸæœ‰åŠŸèƒ½ï¼‰

### ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
æ˜¾ç¤ºå†…å®¹åŒ…æ‹¬ï¼š
- ç”¨æˆ·ID
- ç”¨æˆ·å
- æ˜¾ç¤ºåç§°
- åŠ å…¥æ—¶é—´
- åœ¨çº¿æ—¶é•¿
- IPåœ°å€ï¼ˆç®¡ç†åŠŸèƒ½ï¼‰

## ğŸ“Š 7. ç³»ç»Ÿç»Ÿè®¡åŠŸèƒ½

### ç»Ÿè®¡ä¿¡æ¯
```python
{
    'total_online_users': 30,    # åœ¨çº¿ç”¨æˆ·æ€»æ•°
    'regular_users': 29,         # æ™®é€šç”¨æˆ·æ•°
    'ai_users': 1,               # AIç”¨æˆ·æ•°
    'max_users_limit': 30,       # ç”¨æˆ·ä¸Šé™
    'user_ids_allocated': 29,    # å·²åˆ†é…IDæ•°
    'unique_ips': 25,            # ç‹¬ç«‹IPæ•°
    'user_history_count': 30     # ç”¨æˆ·å†å²è®°å½•æ•°
}
```

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### åç«¯æ”¹è¿›
1. **ç”¨æˆ·æ¨¡å‹æ‰©å±•**ï¼šæ·»åŠ `user_id`ã€`ip_address`ã€`display_name`å­—æ®µ
2. **ç”¨æˆ·ç®¡ç†å™¨å‡çº§**ï¼šæ–°å¢IDç”Ÿæˆã€IPç®¡ç†ã€æ˜¾ç¤ºåç§°æ›´æ–°åŠŸèƒ½
3. **WebSocketå¤„ç†å™¨**ï¼šæ”¯æŒè¿æ¥æ—¶è‡ªåŠ¨åˆ†é…ID
4. **äº‹ä»¶å¤„ç†å™¨**ï¼šæ–°å¢æ˜¾ç¤ºåç§°æ›´æ–°ã€ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢äº‹ä»¶

### å‰ç«¯æ”¹è¿›
1. **äº‹ä»¶ç›‘å¬**ï¼šæ·»åŠ `broadcast_message`ã€`update_display_name`ç­‰äº‹ä»¶
2. **ç”¨æˆ·ç•Œé¢**ï¼šæ–°å¢åŠŸèƒ½æŒ‰é’®å’Œå¿«æ·é”®
3. **çŠ¶æ€ç®¡ç†**ï¼šç»´æŠ¤ç”¨æˆ·IDå’Œæ˜¾ç¤ºåç§°çŠ¶æ€
4. **é”™è¯¯å¤„ç†**ï¼šå®Œå–„ç”¨æˆ·åé¦ˆæœºåˆ¶

### æ•°æ®å­˜å‚¨
- ç”¨æˆ·å†å²è®°å½•ï¼šä½¿ç”¨dequeç»´æŠ¤æœ€è¿‘30ä¸ªç”¨æˆ·è®°å½•
- IPæ˜ å°„ï¼šå­—å…¸ç»“æ„å­˜å‚¨IPåˆ°ç”¨æˆ·çš„æ˜ å°„å…³ç³»
- Socketæ˜ å°„ï¼šåŒå‘æ˜ å°„ç»´æŠ¤ä¼šè¯IDå’ŒSocket IDå…³ç³»

## âœ… æµ‹è¯•éªŒè¯

### åŠŸèƒ½æµ‹è¯•
1. âœ… ç”¨æˆ·IDè‡ªåŠ¨åˆ†é…å’Œå”¯ä¸€æ€§éªŒè¯
2. âœ… ç”¨æˆ·æ·»åŠ å’ŒIPåœ°å€è®°å½•
3. âœ… 30ç”¨æˆ·é™åˆ¶åŠŸèƒ½éªŒè¯
4. âœ… æ˜¾ç¤ºåç§°æ›´æ–°åŠŸèƒ½
5. âœ… ç»Ÿè®¡ä¿¡æ¯å‡†ç¡®æ€§
6. âœ… ç³»ç»Ÿå¥åº·æ£€æŸ¥

### æµ‹è¯•ç»“æœ
```bash
âœ“ ç”¨æˆ·ç®¡ç†åŠŸèƒ½æµ‹è¯•é€šè¿‡
âœ“ ç”¨æˆ·æ·»åŠ åŠŸèƒ½æµ‹è¯•é€šè¿‡  
âœ“ 30ç”¨æˆ·é™åˆ¶åŠŸèƒ½æµ‹è¯•é€šè¿‡
âœ“ ç³»ç»Ÿå¥åº·æ£€æŸ¥é€šè¿‡
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### ç”¨æˆ·ä½¿ç”¨
1. **åŠ å…¥èŠå¤©å®¤**ï¼šè¾“å…¥ç”¨æˆ·åï¼Œç³»ç»Ÿè‡ªåŠ¨åˆ†é…ID
2. **æŸ¥çœ‹ä¸ªäººä¿¡æ¯**ï¼šç‚¹å‡»"ä¿¡æ¯"æŒ‰é’®æˆ–æŒ‰Ctrl+I
3. **ä¿®æ”¹æ˜¾ç¤ºåç§°**ï¼šç‚¹å‡»"æ”¹å"æŒ‰é’®æˆ–æŒ‰Ctrl+R
4. **å‘é€æ¶ˆæ¯**ï¼šæ­£å¸¸è¾“å…¥å‘é€ï¼Œå¯ä»¥çœ‹åˆ°è‡ªå·±çš„æ¶ˆæ¯

### ç®¡ç†å‘˜ä½¿ç”¨
- é€šè¿‡ç»Ÿè®¡æ¥å£ç›‘æ§ç³»ç»ŸçŠ¶æ€
- æŸ¥çœ‹IPåœ°å€åˆ†å¸ƒå’Œç”¨æˆ·æ´»è·ƒåº¦
- ç›‘æ§30ç”¨æˆ·é™åˆ¶æ‰§è¡Œæƒ…å†µ

## ğŸ’¡ æ”¹è¿›äº®ç‚¹

1. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šè‡ªåŠ¨åˆ†é…IDï¼Œæ— éœ€æ‰‹åŠ¨è®¾ç½®å¤æ‚æ ‡è¯†ç¬¦
2. **ç³»ç»Ÿç¨³å®šæ€§**ï¼š30ç”¨æˆ·é™åˆ¶é˜²æ­¢ç³»ç»Ÿè¿‡è½½
3. **åŠŸèƒ½å®Œæ•´æ€§**ï¼šè§£å†³äº†ç”¨æˆ·çœ‹ä¸åˆ°è‡ªå·±æ¶ˆæ¯çš„å…³é”®é—®é¢˜
4. **ç®¡ç†ä¾¿åˆ©æ€§**ï¼šIPåœ°å€è®°å½•ä¾¿äºç³»ç»Ÿç®¡ç†å’Œç›‘æ§
5. **æ‰©å±•æ€§è‰¯å¥½**ï¼šæ–°å¢åŠŸèƒ½ä¸å½±å“ç°æœ‰åŠŸèƒ½ï¼Œå‘åå…¼å®¹

## ğŸ¯ æ€»ç»“

æœ¬æ¬¡æ”¹è¿›æˆåŠŸå®ç°äº†æ‰€æœ‰ç”¨æˆ·éœ€æ±‚ï¼š
- âœ… è¿æ¥æ—¶è‡ªåŠ¨åˆ†é…å”¯ä¸€ç”¨æˆ·ID
- âœ… æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰æ˜¾ç¤ºåç§°
- âœ… åŸºäºIPåœ°å€çš„ç”¨æˆ·è¯†åˆ«ç³»ç»Ÿ
- âœ… 30ç”¨æˆ·åœ¨çº¿é™åˆ¶
- âœ… ä¿®å¤ç”¨æˆ·æ¶ˆæ¯æ˜¾ç¤ºé—®é¢˜

ç³»ç»Ÿç°åœ¨æ›´åŠ ç¨³å®šã€ç”¨æˆ·å‹å¥½ï¼Œå…·å¤‡äº†å®Œå–„çš„ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼Œä¸ºåç»­åŠŸèƒ½æ‰©å±•å¥ å®šäº†è‰¯å¥½åŸºç¡€ã€‚